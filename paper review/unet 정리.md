# U-Net이란
U-Net은 'U-Net: Convolutional Networks for Biomedical Image Segmentation' 이라는 논문에서 제안한 구조로서 매우 적은 수의 학습 데이터로도 정확한 이미지 세그멘테이션 성능을 보여주었으며 ISBI 세포 추적 챌린지 2015에서 큰 점수 차이로 우승했다고 한다. Biomedical Image Segmentation이란 점에서 이 논문의 특성을 살펴 볼 수 있는데 이러한 데이터 셋같은 경우는 의료데이터이기 때문에 데이터가 매우 희박하다. 애초에 의료 데이터는 의료보호법에 의해 보호될 뿐더러, 의사가 앉아서 라벨링이나 하고 있지는 않지 않겠는가?? 그래서 데이터가 너무적다. 그래서 여기서 사용하는 데이터셋은 총 30개밖에 되지 않으며 30MB조차 되지 않는다. 그래서 데이터 Augmentation 기법들을 역시 소개해주고 있다.

# 구조
## 1. 기본구조
U-Net은 오토인코더(autoencoder)와 같은 인코더-디코더(encoder-decoder) 기반 모델에 속한다. 보통 인코딩 단계에서는 입력 이미지의 특징을 포착할 수 있도록 채널의 수를 늘리면서 차원을 축소해 나가며, 디코딩 단계에서는 저차원으로 인코딩된 정보만 이용하여 채널의 수를 줄이고 차원을 늘려서 고차원의 이미지를 복원한다. 하지만 인코딩 단계에서 차원 축소를 거치면서 이미지 객체에 대한 자세한 위치 정보를 잃게 되고, 디코딩 단계에서도 저차원의 정보만을 이용하기 때문에 위치 정보 손실을 회복하지 못하게 된다.
![[Pasted image 20240519122802.png]]

U-Net의 기본 아이디어는 저차원 뿐만 아니라 고차원 정보도 이용하여 이미지의 특징을 추출함과 동시에 정확한 위치 파악도 가능하게 하자는 것이다. 이를 위해서 인코딩 단계의 각 레이어에서 얻은 특징을 디코딩 단계의 각 레이어에 합치는(concatenation) 방법을 사용한다. 인코더 레이어와 디코더 레이어의 직접 연결을 스킵 연결(skip connection)이라고 한다.
![[Pasted image 20240519122851.png]]
원래 논문에서는 신경원망 구조를 스킵 연결을 평행하게 두고 가운데를 기준으로 좌우가 대칭이 되도록 레이어를 배치하여, 이름 그대로 U자 형으로 만들었다.
![[Pasted image 20240519122925.png]]
U-Net 은 인코더 또는 축소경로(contracting path)와 디코더 또는 확장경로(expending path)로 구성되며 두 구조는 서로 대칭적이다. 인코더와 디코더를 연결하는 부분을 브릿지(bridge)라고 한다.

  

### 1. 차이점

#### 구조

- **UNet**: 인코더-디코더 구조로, 스킵 연결을 통해 세부 정보를 보존하면서 이미지를 복원
- **Transformer**: 이미지를 패치로 분할하고, 셀프 어텐션을 사용하여 각 패치 간의 관계를 학습한 후 디코더를 통해 이미지를 복원

#### 컨텍스트 캡처

- **UNet**: 로컬 컨텍스트를 잘 캡처하지만 글로벌 컨텍스트를 고려하기에는 한계
- **Transformer**: 셀프 어텐션을 통해 이미지의 전역적인 구조를 파악하여 글로벌 컨텍스트를 잘 이해합니다.

#### 계산 비용

- **UNet**: 상대적으로 적은 파라미터와 간단한 구조를 가지고 있어 효율적
- **Transformer**: 셀프 어텐션 계산 비용이 높아 대규모 이미지에 적용하기 어려울 수 있음

#### 구현 및 훈련

- **UNet**: 구조가 단순하여 구현과 튜닝이 상대적으로 쉬움
- **Transformer**: 구조가 복잡하여 구현과 훈련이 어려울 수 있음.

### 2. 장단점

#### UNet의 장단점

- **장점**:
    
    - 효율적인 모델 구조로 빠른 학습과 효율적인 메모리 사용이 가능합니다.
    - 스킵 연결을 통해 세부 정보를 보존하면서 노이즈를 제거할 수 있습니다.
- **단점**:
    
    - 글로벌 컨텍스트를 고려하기에는 제한이 있습니다.
    - 복잡한 패턴이나 글로벌 관계를 잘 처리하지 못할 수 있습니다.

#### Transformer의 장단점

- **장점**:
    
    - 셀프 어텐션을 통해 글로벌 컨텍스트를 잘 캡처하여 노이즈 제거에 우수합니다.
    - 다양한 종류의 데이터와 멀티모달 모델링에 적용하기 용이합니다.
- **단점**:
    
    - 셀프 어텐션 계산 비용이 높아 대규모 데이터셋에 적용하기 어려울 수 있습니다.
    - 모델 구조가 복잡하여 구현과 훈련이 어려울 수 있습니다.

이러한 장단점을 고려하여 프로젝트나 응용 분야에 적합한 모델을 선택할 수 있습니다. UNet은 간단하고 효율적인 모델을 원할 때 유용하며, Transformer는 글로벌 컨텍스트를 고려해야 할 때나 멀티모달 데이터 처리에 적합합니다.